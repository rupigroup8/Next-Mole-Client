{"ast":null,"code":"/**\n * Represents spring force, which updates forces acting on two bodies, connected\n * by a spring.\n *\n * @param {Object} options for the spring force\n * @param {Number=} options.springCoeff spring force coefficient.\n * @param {Number=} options.springLength desired length of a spring at rest.\n */\nmodule.exports = function (options) {\n  var merge = require('ngraph.merge');\n\n  var random = require('ngraph.random').random(42);\n\n  var expose = require('ngraph.expose');\n\n  options = merge(options, {\n    springCoeff: 0.0002,\n    springLength: 80\n  });\n  var api = {\n    /**\n     * Upsates forces acting on a spring\n     */\n    update: function (spring) {\n      var body1 = spring.from,\n          body2 = spring.to,\n          length = spring.length < 0 ? options.springLength : spring.length,\n          dx = body2.pos.x - body1.pos.x,\n          dy = body2.pos.y - body1.pos.y,\n          r = Math.sqrt(dx * dx + dy * dy);\n\n      if (r === 0) {\n        dx = (random.nextDouble() - 0.5) / 50;\n        dy = (random.nextDouble() - 0.5) / 50;\n        r = Math.sqrt(dx * dx + dy * dy);\n      }\n\n      var d = r - length;\n      var coeff = (!spring.coeff || spring.coeff < 0 ? options.springCoeff : spring.coeff) * d / r;\n      body1.force.x += coeff * dx;\n      body1.force.y += coeff * dy;\n      body2.force.x -= coeff * dx;\n      body2.force.y -= coeff * dy;\n    }\n  };\n  expose(options, api, ['springCoeff', 'springLength']);\n  return api;\n};","map":{"version":3,"sources":["/Users/rgoren/Desktop/nextMoleAppClient/next_mole_client/node_modules/ngraph.physics.simulator/lib/springForce.js"],"names":["module","exports","options","merge","require","random","expose","springCoeff","springLength","api","update","spring","body1","from","body2","to","length","dx","pos","x","dy","y","r","Math","sqrt","nextDouble","d","coeff","force"],"mappings":"AAAA;;;;;;;;AAQAA,MAAM,CAACC,OAAP,GAAiB,UAAUC,OAAV,EAAmB;AAClC,MAAIC,KAAK,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AACA,MAAIC,MAAM,GAAGD,OAAO,CAAC,eAAD,CAAP,CAAyBC,MAAzB,CAAgC,EAAhC,CAAb;;AACA,MAAIC,MAAM,GAAGF,OAAO,CAAC,eAAD,CAApB;;AAEAF,EAAAA,OAAO,GAAGC,KAAK,CAACD,OAAD,EAAU;AACvBK,IAAAA,WAAW,EAAE,MADU;AAEvBC,IAAAA,YAAY,EAAE;AAFS,GAAV,CAAf;AAKA,MAAIC,GAAG,GAAG;AACR;;;AAGAC,IAAAA,MAAM,EAAG,UAAUC,MAAV,EAAkB;AACzB,UAAIC,KAAK,GAAGD,MAAM,CAACE,IAAnB;AAAA,UACIC,KAAK,GAAGH,MAAM,CAACI,EADnB;AAAA,UAEIC,MAAM,GAAGL,MAAM,CAACK,MAAP,GAAgB,CAAhB,GAAoBd,OAAO,CAACM,YAA5B,GAA2CG,MAAM,CAACK,MAF/D;AAAA,UAGIC,EAAE,GAAGH,KAAK,CAACI,GAAN,CAAUC,CAAV,GAAcP,KAAK,CAACM,GAAN,CAAUC,CAHjC;AAAA,UAIIC,EAAE,GAAGN,KAAK,CAACI,GAAN,CAAUG,CAAV,GAAcT,KAAK,CAACM,GAAN,CAAUG,CAJjC;AAAA,UAKIC,CAAC,GAAGC,IAAI,CAACC,IAAL,CAAUP,EAAE,GAAGA,EAAL,GAAUG,EAAE,GAAGA,EAAzB,CALR;;AAOA,UAAIE,CAAC,KAAK,CAAV,EAAa;AACTL,QAAAA,EAAE,GAAG,CAACZ,MAAM,CAACoB,UAAP,KAAsB,GAAvB,IAA8B,EAAnC;AACAL,QAAAA,EAAE,GAAG,CAACf,MAAM,CAACoB,UAAP,KAAsB,GAAvB,IAA8B,EAAnC;AACAH,QAAAA,CAAC,GAAGC,IAAI,CAACC,IAAL,CAAUP,EAAE,GAAGA,EAAL,GAAUG,EAAE,GAAGA,EAAzB,CAAJ;AACH;;AAED,UAAIM,CAAC,GAAGJ,CAAC,GAAGN,MAAZ;AACA,UAAIW,KAAK,GAAG,CAAE,CAAChB,MAAM,CAACgB,KAAR,IAAiBhB,MAAM,CAACgB,KAAP,GAAe,CAAjC,GAAsCzB,OAAO,CAACK,WAA9C,GAA4DI,MAAM,CAACgB,KAApE,IAA6ED,CAA7E,GAAiFJ,CAA7F;AAEAV,MAAAA,KAAK,CAACgB,KAAN,CAAYT,CAAZ,IAAiBQ,KAAK,GAAGV,EAAzB;AACAL,MAAAA,KAAK,CAACgB,KAAN,CAAYP,CAAZ,IAAiBM,KAAK,GAAGP,EAAzB;AAEAN,MAAAA,KAAK,CAACc,KAAN,CAAYT,CAAZ,IAAiBQ,KAAK,GAAGV,EAAzB;AACAH,MAAAA,KAAK,CAACc,KAAN,CAAYP,CAAZ,IAAiBM,KAAK,GAAGP,EAAzB;AACD;AA1BO,GAAV;AA6BAd,EAAAA,MAAM,CAACJ,OAAD,EAAUO,GAAV,EAAe,CAAC,aAAD,EAAgB,cAAhB,CAAf,CAAN;AACA,SAAOA,GAAP;AACD,CAzCD","sourcesContent":["/**\n * Represents spring force, which updates forces acting on two bodies, connected\n * by a spring.\n *\n * @param {Object} options for the spring force\n * @param {Number=} options.springCoeff spring force coefficient.\n * @param {Number=} options.springLength desired length of a spring at rest.\n */\nmodule.exports = function (options) {\n  var merge = require('ngraph.merge');\n  var random = require('ngraph.random').random(42);\n  var expose = require('ngraph.expose');\n\n  options = merge(options, {\n    springCoeff: 0.0002,\n    springLength: 80\n  });\n\n  var api = {\n    /**\n     * Upsates forces acting on a spring\n     */\n    update : function (spring) {\n      var body1 = spring.from,\n          body2 = spring.to,\n          length = spring.length < 0 ? options.springLength : spring.length,\n          dx = body2.pos.x - body1.pos.x,\n          dy = body2.pos.y - body1.pos.y,\n          r = Math.sqrt(dx * dx + dy * dy);\n\n      if (r === 0) {\n          dx = (random.nextDouble() - 0.5) / 50;\n          dy = (random.nextDouble() - 0.5) / 50;\n          r = Math.sqrt(dx * dx + dy * dy);\n      }\n\n      var d = r - length;\n      var coeff = ((!spring.coeff || spring.coeff < 0) ? options.springCoeff : spring.coeff) * d / r;\n\n      body1.force.x += coeff * dx;\n      body1.force.y += coeff * dy;\n\n      body2.force.x -= coeff * dx;\n      body2.force.y -= coeff * dy;\n    }\n  };\n\n  expose(options, api, ['springCoeff', 'springLength']);\n  return api;\n}\n"]},"metadata":{},"sourceType":"script"}